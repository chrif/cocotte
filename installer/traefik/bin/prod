#!/usr/bin/env sh

set -eu

set -a
. ./.env
set +a

eval $(docker-machine env ${COCOTTE_MACHINE})

# take down
docker stop traefik || true
docker rm traefik || true
docker-compose down -v --remove-orphans

# build
docker network create traefik  || true
docker volume create traefikssl  || true
docker-compose -f docker-compose.yml build

# bring up
docker-compose -f docker-compose.yml up -d traefik
