#!/usr/bin/env sh

set -eu

set -a
. ./.env
. ./.env-override
set +a

eval $(docker-machine env -u)

# take down
docker stop traefik || true
docker rm traefik || true
docker-compose down -v --remove-orphans

# build
docker network create traefik  || true
docker volume create traefikssl  || true
docker-compose -f docker-compose.yml build

# bring up
docker-compose up -d traefik
docker logs -f traefik
